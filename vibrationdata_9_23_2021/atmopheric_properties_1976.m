%
%  atmopheric_properties_1976.m  ver 1.1  by Tom Irvine
%
%  http://www.pdas.com/atmos.html
%
%  Properties Of The U.S. Standard Atmosphere 1976
%
function[air_pressure,mass_dens,temp_K,temp_C,sound_speed,visc,kvisc]=...
                                         atmopheric_properties_1976(alt,iu)
%
%   input alt unit:  ft for iu=1
%                     m for iu=2
%
%
%   output for iu=1
%
%      air_pressure:  psf
%         mass_dens:  slugs/ft^3
%       sound_speed:  ft/sec
%              visc:  slugs/ft-s
%             kvisc:  ft^2/sec
%
%   output for iu=2
%
%      air_pressure:  Pa
%         mass_dens:  kg/m^3
%       sound_speed:  m/sec
%              visc:  kg/m-s
%             kvisc:  m^2/sec


air_pressure=0;
mass_dens=0;
temp_K=0;
temp_C=0;
sound_speed=0;
visc=0;
kvisc=0;


if(iu==1)  % convert feet to Kft
    
   alt=alt/1000;
   
   if(alt>280)
       warndlg('Maximum altitude = 280 Kft')
       return;
   end
   
   
else       % convert m to Km 
    
   alt=alt/1000;
   
   if(alt>86)
       warndlg('Maximum altitude = 86 Km')
       return;
   end   
   
end
 
%
%  Table Columns
%

table_eng=...
[ alt   sigma    delta   theta  temp   press    dens      a    visc  k.visc
  Kft                           degR lb/sq.ft s/cu.ft    fps s/ft-s sq.ft/s
  -5 1.155E+0 1.194E+0 1.0344 536.5 2.528E+3 2.745E-3 1135.5 0.384 1.40E-4
   0 1.000E+0 1.000E+0 1.0000 518.7 2.116E+3 2.377E-3 1116.5 0.374 1.57E-4
   5 8.617E-1 8.321E-1 0.9656 500.8 1.761E+3 2.048E-3 1097.1 0.364 1.78E-4
  10 7.386E-1 6.878E-1 0.9313 483.0 1.456E+3 1.756E-3 1077.4 0.353 2.01E-4
  15 6.295E-1 5.646E-1 0.8969 465.2 1.195E+3 1.496E-3 1057.4 0.343 2.29E-4
  20 5.332E-1 4.599E-1 0.8626 447.4 9.733E+2 1.267E-3 1036.9 0.332 2.62E-4
  25 4.486E-1 3.716E-1 0.8283 429.6 7.863E+2 1.066E-3 1016.1 0.322 3.02E-4
  30 3.747E-1 2.975E-1 0.7940 411.8 6.297E+2 8.907E-4  994.8 0.311 3.49E-4
  35 3.106E-1 2.360E-1 0.7598 394.1 4.993E+2 7.382E-4  973.1 0.300 4.06E-4
  40 2.471E-1 1.858E-1 0.7519 390.0 3.931E+2 5.873E-4  968.1 0.297 5.06E-4
  45 1.945E-1 1.462E-1 0.7519 390.0 3.094E+2 4.623E-4  968.1 0.297 6.42E-4
  50 1.531E-1 1.151E-1 0.7519 390.0 2.436E+2 3.639E-4  968.1 0.297 8.16E-4
  55 1.205E-1 9.063E-2 0.7519 390.0 1.918E+2 2.865E-4  968.1 0.297 1.04E-3
  60 9.492E-2 7.137E-2 0.7519 390.0 1.510E+2 2.256E-4  968.1 0.297 1.32E-3
  65 7.475E-2 5.620E-2 0.7519 390.0 1.189E+2 1.777E-4  968.1 0.297 1.67E-3
  70 5.856E-2 4.429E-2 0.7563 392.2 9.373E+1 1.392E-4  970.9 0.298 2.14E-3
  75 4.591E-2 3.496E-2 0.7615 395.0 7.399E+1 1.091E-4  974.3 0.300 2.75E-3
  80 3.606E-2 2.765E-2 0.7668 397.7 5.851E+1 8.571E-5  977.6 0.302 3.52E-3
  85 2.837E-2 2.190E-2 0.7720 400.4 4.635E+1 6.743E-5  981.0 0.304 4.50E-3
  90 2.236E-2 1.738E-2 0.7772 403.1 3.678E+1 5.315E-5  984.3 0.305 5.74E-3
  95 1.765E-2 1.381E-2 0.7825 405.9 2.923E+1 4.196E-5  987.6 0.307 7.32E-3
 100 1.396E-2 1.100E-2 0.7877 408.6 2.327E+1 3.318E-5  990.9 0.309 9.30E-3
 105 1.106E-2 8.769E-3 0.7930 411.3 1.856E+1 2.628E-5  994.2 0.310 1.18E-2
 110 8.691E-3 7.011E-3 0.8067 418.4 1.484E+1 2.066E-5 1002.7 0.315 1.52E-2
 115 6.853E-3 5.629E-3 0.8213 426.0 1.191E+1 1.629E-5 1011.8 0.319 1.96E-2
 120 5.427E-3 4.537E-3 0.8359 433.6 9.601E+0 1.290E-5 1020.8 0.324 2.51E-2
 125 4.316E-3 3.671E-3 0.8506 441.2 7.768E+0 1.026E-5 1029.7 0.329 3.20E-2
 130 3.446E-3 2.981E-3 0.8652 448.8 6.309E+0 8.190E-6 1038.5 0.333 4.07E-2
 135 2.762E-3 2.430E-3 0.8798 456.3 5.142E+0 6.565E-6 1047.2 0.338 5.15E-2
 140 2.222E-3 1.987E-3 0.8945 463.9 4.206E+0 5.281E-6 1055.9 0.342 6.48E-2
 145 1.794E-3 1.631E-3 0.9091 471.5 3.452E+0 4.264E-6 1064.5 0.347 8.13E-2
 150 1.454E-3 1.343E-3 0.9237 479.1 2.842E+0 3.455E-6 1073.0 0.351 1.02E-1
 155 1.182E-3 1.109E-3 0.9383 486.6 2.347E+0 2.809E-6 1081.4 0.356 1.27E-1
 160 9.769E-4 9.176E-4 0.9393 487.2 1.942E+0 2.322E-6 1082.0 0.356 1.53E-1
 165 8.083E-4 7.592E-4 0.9393 487.2 1.607E+0 1.921E-6 1082.0 0.356 1.85E-1
 170 6.716E-4 6.282E-4 0.9354 485.2 1.329E+0 1.596E-6 1079.8 0.355 2.22E-1
 175 5.633E-4 5.187E-4 0.9208 477.6 1.098E+0 1.339E-6 1071.3 0.350 2.62E-1
 180 4.712E-4 4.270E-4 0.9063 470.1 9.037E-1 1.120E-6 1062.8 0.346 3.09E-1
 185 3.931E-4 3.505E-4 0.8917 462.5 7.417E-1 9.343E-7 1054.3 0.341 3.65E-1
 190 3.269E-4 2.868E-4 0.8772 455.0 6.069E-1 7.771E-7 1045.6 0.337 4.34E-1
 195 2.711E-4 2.339E-4 0.8626 447.4 4.949E-1 6.444E-7 1036.9 0.332 5.16E-1
 200 2.241E-4 1.901E-4 0.8481 439.9 4.023E-1 5.327E-7 1028.2 0.328 6.16E-1
 205 1.847E-4 1.540E-4 0.8336 432.4 3.258E-1 4.390E-7 1019.3 0.323 7.37E-1
 210 1.517E-4 1.242E-4 0.8191 424.8 2.629E-1 3.606E-7 1010.4 0.319 8.84E-1
 215 1.242E-4 9.990E-5 0.8045 417.3 2.114E-1 2.951E-7 1001.4 0.314 1.06E+0
 220 1.013E-4 8.001E-5 0.7900 409.8 1.693E-1 2.407E-7  992.3 0.309 1.29E+0
 225 8.230E-5 6.383E-5 0.7755 402.2 1.351E-1 1.956E-7  983.2 0.305 1.56E+0
 230 6.663E-5 5.070E-5 0.7610 394.7 1.073E-1 1.584E-7  974.0 0.300 1.89E+0
 235 5.372E-5 4.011E-5 0.7466 387.2 8.488E-2 1.277E-7  964.7 0.295 2.31E+0
 240 4.295E-5 3.160E-5 0.7358 381.6 6.687E-2 1.021E-7  957.6 0.292 2.86E+0
 245 3.421E-5 2.482E-5 0.7254 376.3 5.252E-2 8.131E-8  950.9 0.288 3.54E+0
 250 2.716E-5 1.942E-5 0.7151 370.9 4.110E-2 6.456E-8  944.1 0.285 4.41E+0
 255 2.150E-5 1.515E-5 0.7048 365.5 3.206E-2 5.109E-8  937.3 0.281 5.50E+0
 260 1.696E-5 1.177E-5 0.6944 360.2 2.492E-2 4.030E-8  930.4 0.278 6.89E+0
 265 1.333E-5 9.118E-6 0.6841 354.8 1.930E-2 3.168E-8  923.4 0.274 8.65E+0
 270 1.044E-5 7.034E-6 0.6738 349.5 1.489E-2 2.481E-8  916.4 0.270 1.09E+1
 275 8.148E-6 5.406E-6 0.6635 344.1 1.144E-2 1.937E-8  909.4 0.267 1.38E+1
 280 6.335E-6 4.138E-6 0.6532 338.8 8.757E-3 1.506E-8  902.3 0.263 1.75E+1];    


%  alt    sigma     delta   theta  temp   press    dens     a    visc  k.visc
%   Km                             degK  N/sq.m   kg/cu.m m/sec kg/m-s sq.m/s

table_metric=...
 [-2 1.2067E+0 1.2611E+0 1.0451 301.2 1.278E+5 1.478E+0 347.9 18.51 1.25E-5
   0 1.0000E+0 1.0000E+0 1.0000 288.1 1.013E+5 1.225E+0 340.3 17.89 1.46E-5
   2 8.2168E-1 7.8462E-1 0.9549 275.2 7.950E+4 1.007E+0 332.5 17.26 1.71E-5
   4 6.6885E-1 6.0854E-1 0.9098 262.2 6.166E+4 8.193E-1 324.6 16.61 2.03E-5
   6 5.3887E-1 4.6600E-1 0.8648 249.2 4.722E+4 6.601E-1 316.5 15.95 2.42E-5
   8 4.2921E-1 3.5185E-1 0.8198 236.2 3.565E+4 5.258E-1 308.1 15.27 2.90E-5
  10 3.3756E-1 2.6153E-1 0.7748 223.3 2.650E+4 4.135E-1 299.5 14.58 3.53E-5
  12 2.5464E-1 1.9146E-1 0.7519 216.6 1.940E+4 3.119E-1 295.1 14.22 4.56E-5
  14 1.8600E-1 1.3985E-1 0.7519 216.6 1.417E+4 2.279E-1 295.1 14.22 6.24E-5
  16 1.3589E-1 1.0217E-1 0.7519 216.6 1.035E+4 1.665E-1 295.1 14.22 8.54E-5
  18 9.9302E-2 7.4662E-2 0.7519 216.6 7.565E+3 1.216E-1 295.1 14.22 1.17E-4
  20 7.2578E-2 5.4569E-2 0.7519 216.6 5.529E+3 8.891E-2 295.1 14.22 1.60E-4
  22 5.2660E-2 3.9945E-2 0.7585 218.6 4.047E+3 6.451E-2 296.4 14.32 2.22E-4
  24 3.8316E-2 2.9328E-2 0.7654 220.6 2.972E+3 4.694E-2 297.7 14.43 3.07E-4
  26 2.7964E-2 2.1597E-2 0.7723 222.5 2.188E+3 3.426E-2 299.1 14.54 4.24E-4
  28 2.0470E-2 1.5950E-2 0.7792 224.5 1.616E+3 2.508E-2 300.4 14.65 5.84E-4
  30 1.5028E-2 1.1813E-2 0.7861 226.5 1.197E+3 1.841E-2 301.7 14.75 8.01E-4
  32 1.1065E-2 8.7740E-3 0.7930 228.5 8.890E+2 1.355E-2 303.0 14.86 1.10E-3
  34 8.0709E-3 6.5470E-3 0.8112 233.7 6.634E+2 9.887E-3 306.5 15.14 1.53E-3
  36 5.9245E-3 4.9198E-3 0.8304 239.3 4.985E+2 7.257E-3 310.1 15.43 2.13E-3
  38 4.3806E-3 3.7218E-3 0.8496 244.8 3.771E+2 5.366E-3 313.7 15.72 2.93E-3
  40 3.2615E-3 2.8337E-3 0.8688 250.4 2.871E+2 3.995E-3 317.2 16.01 4.01E-3
  42 2.4445E-3 2.1708E-3 0.8880 255.9 2.200E+2 2.995E-3 320.7 16.29 5.44E-3
  44 1.8438E-3 1.6727E-3 0.9072 261.4 1.695E+2 2.259E-3 324.1 16.57 7.34E-3
  46 1.3992E-3 1.2961E-3 0.9263 266.9 1.313E+2 1.714E-3 327.5 16.85 9.83E-3
  48 1.0748E-3 1.0095E-3 0.9393 270.6 1.023E+2 1.317E-3 329.8 17.04 1.29E-2
  50 8.3819E-4 7.8728E-4 0.9393 270.6 7.977E+1 1.027E-3 329.8 17.04 1.66E-2
  52 6.5758E-4 6.1395E-4 0.9336 269.0 6.221E+1 8.055E-4 328.8 16.96 2.10E-2
  54 5.2158E-4 4.7700E-4 0.9145 263.5 4.833E+1 6.389E-4 325.4 16.68 2.61E-2
  56 4.1175E-4 3.6869E-4 0.8954 258.0 3.736E+1 5.044E-4 322.0 16.40 3.25E-2
  58 3.2344E-4 2.8344E-4 0.8763 252.5 2.872E+1 3.962E-4 318.6 16.12 4.07E-2
  60 2.5276E-4 2.1668E-4 0.8573 247.0 2.196E+1 3.096E-4 315.1 15.84 5.11E-2
  62 1.9647E-4 1.6468E-4 0.8382 241.5 1.669E+1 2.407E-4 311.5 15.55 6.46E-2
  64 1.5185E-4 1.2439E-4 0.8191 236.0 1.260E+1 1.860E-4 308.0 15.26 8.20E-2
  66 1.1668E-4 9.3354E-5 0.8001 230.5 9.459E+0 1.429E-4 304.4 14.97 1.05E-1
  68 8.9101E-5 6.9593E-5 0.7811 225.1 7.051E+0 1.091E-4 300.7 14.67 1.34E-1
  70 6.7601E-5 5.1515E-5 0.7620 219.6 5.220E+0 8.281E-5 297.1 14.38 1.74E-1
  72 5.0905E-5 3.7852E-5 0.7436 214.3 3.835E+0 6.236E-5 293.4 14.08 2.26E-1
  74 3.7856E-5 2.7635E-5 0.7300 210.3 2.800E+0 4.637E-5 290.7 13.87 2.99E-1
  76 2.8001E-5 2.0061E-5 0.7164 206.4 2.033E+0 3.430E-5 288.0 13.65 3.98E-1
  78 2.0597E-5 1.4477E-5 0.7029 202.5 1.467E+0 2.523E-5 285.3 13.43 5.32E-1
  80 1.5063E-5 1.0384E-5 0.6893 198.6 1.052E+0 1.845E-5 282.5 13.21 7.16E-1
  82 1.0950E-5 7.4002E-6 0.6758 194.7 7.498E-1 1.341E-5 279.7 12.98 9.68E-1
  84 7.9106E-6 5.2391E-6 0.6623 190.8 5.308E-1 9.690E-6 276.9 12.76 1.32E+0
  86 5.6777E-6 3.6835E-6 0.6488 186.9 3.732E-1 6.955E-6 274.1 12.53 1.80E+0];


if(iu==1)
    table=table_eng;
else
    table=table_metric;    
end


sz=size(table);
n=sz(1);


          h=table(:,1);
       temp=table(:,5);
          p=table(:,6);
       dens=table(:,7);
     tspeed=table(:,8);
          v=table(:,9);
         kv=table(:,10);




for i=1:(n-1)

    if( alt >= h(i) && alt < h(i+1) )

        len = h(i+1)-h(i);

        c2  = (alt-h(i))/len;
        c1  = 1. -c2;

        air_pressure = c1*p(i)      + c2*p(i+1);
        mass_dens    = c1*dens(i)   + c2*dens(i+1);
        temperature  = c1*temp(i)   + c2*temp(i+1);        
        sound_speed  = c1*tspeed(i) + c2*tspeed(i+1);  
               visc  = c1*v(i)      + c2*v(i+1);
              kvisc  = c1*kv(i)     + c2*kv(i+1);
              
        break;

    end
        
end

if(iu==1)  % convert R to K
    
    temp_K=temperature*(5/9);

else
    
    temp_K=temperature;

end    

temp_C=temp_K-273.15;

